{% if variables.categories %}
<h4>{% trans %}Filtrer par:{% endtrans %}</h4>
<div class="spacer spacer-sm"></div>
  {% for category in variables.categories %}
  <p class="media-heading text-muted">{{ category.term.name.value }}</p>
  <ul class="filters-list">
    {% for child in category.children %}
      <li class="{{ child.alias in variables.current_aliases ? 'active' }}">
        {% set filtres = [child.alias] %}

        {% if variables.current_aliases[0] is defined %}
          {% set filtres = variables.current_aliases|merge([child.alias]) %}
        {% endif %}

        {% if child.alias in variables.current_aliases %}
          {# Build filtres for the current selected item - to remove himself on second click #}
          {% set filtres = [] %}
          {% for alias in variables.current_aliases %}
             {% if alias != child.alias %}
               {% set filtres = filtres|merge([alias]) %}
             {% endif %}
          {% endfor %}
          <a href="{{ path('<current>', {'filtres': filtres}, {'fragment': 'produits-recommandes'}) }}" class="retraitespopulaires-icon retraitespopulaires-icon-2x retraitespopulaires-icon-checked text-{{ variables.theme }}"></a>
        {% else %}
          <a href="{{ path('<current>', {'filtres': filtres}, {'fragment': 'produits-recommandes'}) }}" class="retraitespopulaires-icon retraitespopulaires-icon-2x retraitespopulaires-icon-unchecked text-{{ variables.theme }}"></a>
        {% endif %}
        <a href="{{ path('<current>', {'filtres': filtres}, {'fragment': 'produits-recommandes'}) }}" class="pretty-link text-{{ variables.theme }}">{{ child.term.name.value }}</a></li>
    {% endfor %}
  </ul>
  <div class="spacer spacer-sm"></div>
  {% endfor %}
{% endif %}
