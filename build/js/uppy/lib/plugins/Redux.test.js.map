{"version":3,"sources":["../../src/plugins/Redux.test.js"],"names":["describe","it","actionFunction","dispatchFunction","redux","action","dispatch","expect","toEqual","opts","toBe","toThrow","core","on","jest","fn","handleStateUpdate","install","mock","calls","length","state","off","uninstall","actionMock","mockReturnValue","foo","dispatchMock","prev","a","c","patch"],"mappings":"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","file":"Redux.test.js","sourcesContent":["import ReduxPlugin from './Redux'\nimport Plugin from '../core/Plugin'\n\ndescribe('uploader/reduxPlugin', () => {\n  it('should initialise successfully', () => {\n    const actionFunction = () => {}\n    const dispatchFunction = () => {}\n    const redux = new ReduxPlugin(null, {\n      action: actionFunction,\n      dispatch: dispatchFunction\n    })\n    expect(redux instanceof Plugin).toEqual(true)\n    expect(redux.opts.action).toBe(actionFunction)\n    expect(redux.opts.dispatch).toBe(dispatchFunction)\n  })\n\n  it('should throw an error if the action option is not specified', () => {\n    const dispatchFunction = () => {}\n\n    expect(() => {\n      new ReduxPlugin(null, { dispatch: dispatchFunction }) // eslint-disable-line no-new\n    }).toThrow('action option is not defined')\n  })\n\n  it('should throw an error if the dispatch option is not specified', () => {\n    const actionFunction = () => {}\n\n    expect(() => {\n      new ReduxPlugin(null, { action: actionFunction }) // eslint-disable-line no-new\n    }).toThrow('dispatch option is not defined')\n  })\n\n  describe('install', () => {\n    it('should subscribe to uppy events', () => {\n      const core = {\n        on: jest.fn()\n      }\n\n      const redux = new ReduxPlugin(core, {\n        action: () => {},\n        dispatch: () => {}\n      })\n      redux.handleStateUpdate = jest.fn()\n      redux.install()\n\n      expect(core.on.mock.calls.length).toEqual(1)\n      expect(core.on.mock.calls[0]).toEqual([\n        'state-update',\n        redux.handleStateUpdate\n      ])\n    })\n\n    it('should call this.handleStateUpdate with the current state on install', () => {\n      const core = {\n        on: jest.fn()\n      }\n\n      const redux = new ReduxPlugin(core, {\n        action: () => {},\n        dispatch: () => {}\n      })\n      redux.handleStateUpdate = jest.fn()\n      redux.install()\n\n      expect(redux.handleStateUpdate.mock.calls.length).toEqual(1)\n      expect(redux.handleStateUpdate.mock.calls[0]).toEqual([\n        {},\n        core.state,\n        core.state\n      ])\n    })\n  })\n\n  describe('uninstall', () => {\n    it('should should unsubscribe from uppy events on uninstall', () => {\n      const core = {\n        off: jest.fn()\n      }\n\n      const redux = new ReduxPlugin(core, {\n        action: () => {},\n        dispatch: () => {}\n      })\n      redux.uninstall()\n\n      expect(core.off.mock.calls.length).toEqual(1)\n      expect(core.off.mock.calls[0]).toEqual([\n        'state-update',\n        redux.handleStateUpdate\n      ])\n    })\n  })\n\n  describe('handleStateUpdate', () => {\n    it('should create a redux action with the new state', () => {\n      const core = {}\n      const actionMock = jest.fn().mockReturnValue({\n        foo: 'bar'\n      })\n      const dispatchMock = () => {}\n\n      const redux = new ReduxPlugin(core, {\n        action: actionMock,\n        dispatch: dispatchMock\n      })\n      const prev = { a: 'b' }\n      const state = { a: 'b', c: 'd' }\n      const patch = { c: 'd' }\n      redux.handleStateUpdate(prev, state, patch)\n      expect(actionMock.mock.calls.length).toEqual(1)\n      expect(actionMock.mock.calls[0]).toEqual([prev, state, patch])\n    })\n\n    it('should dispatch a redux action with the new state', () => {\n      const core = {}\n      const actionMock = jest.fn().mockReturnValue({\n        foo: 'bar'\n      })\n      const dispatchMock = jest.fn()\n\n      const redux = new ReduxPlugin(core, {\n        action: actionMock,\n        dispatch: dispatchMock\n      })\n      const prev = { a: 'b' }\n      const state = { a: 'b', c: 'd' }\n      const patch = { c: 'd' }\n      redux.handleStateUpdate(prev, state, patch)\n      expect(dispatchMock.mock.calls.length).toEqual(1)\n      expect(dispatchMock.mock.calls[0]).toEqual([{ foo: 'bar' }])\n    })\n  })\n})\n"]}